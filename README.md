# Telegram AI Chatbot with OpenAI, Aiogram 3, and FastAPI

## üìå Task Description

### **–¢–µ—Å—Ç–æ–≤–∞—è –∑–∞–¥–∞—á–∞: –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞ Telegram-–±–æ—Ç–∞ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º OpenAI, Aiogram 3 –∏ FastAPI**

–í–∞–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Ä–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å Telegram-–±–æ—Ç–∞, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –æ—Ç–≤–µ—á–∞—Ç—å –Ω–∞ —Ä–∞–∑–ª–∏—á–Ω—ã–µ –≤–æ–ø—Ä–æ—Å—ã –∏ –∑–∞–ø—Ä–æ—Å—ã –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π, –∏—Å–ø–æ–ª—å–∑—É—è OpenAI (–Ω–∞–ø—Ä–∏–º–µ—Ä, GPT-3.5). –ë–æ—Ç –¥–æ–ª–∂–µ–Ω –≤–µ—Å—Ç–∏ –¥–∏–∞–ª–æ–≥–∏ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏, –∑–∞–ø–æ–º–∏–Ω–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é –æ–±—â–µ–Ω–∏—è –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –µ—ë –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤. –¢–∞–∫–∂–µ –±–æ—Ç –¥–æ–ª–∂–µ–Ω –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è—Ç—å –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏—è –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–Ω–¥–∏–≤–∏–¥—É–∞–ª—å–Ω–æ–π –∏—Å—Ç–æ—Ä–∏–∏ –ø–µ—Ä–µ–ø–∏—Å–∫–∏.

–ë–æ—Ç –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å —Ä–∞–∑–¥–µ–ª—ë–Ω –Ω–∞ —Ç—Ä–∏ –Ω–µ–∑–∞–≤–∏—Å–∏–º—ã—Ö —Å–µ—Ä–≤–∏—Å–∞:

1. **Bot Service (Aiogram 3)**:

   - –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π —á–µ—Ä–µ–∑ Telegram.
   - –û–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –∫–æ–º–∞–Ω–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π.
   - –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å NLP-—Å–µ—Ä–≤–∏—Å–æ–º –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ –∏ –æ—Ç–ø—Ä–∞–≤–∫–∞ –∏—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º.

2. **API Service (FastAPI)**:

   - REST API –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è, –ø–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π).
   - REST API –¥–ª—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–∏—è —Ä–∞–±–æ—Ç—ã –±–æ—Ç–∞ (—Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è, –∫–æ–Ω—Ç—Ä–æ–ª—å —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç–∏).

3. **NLP Service (OpenAI)**:
   - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å OpenAI API –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Ç–µ–∫—Å—Ç–æ–≤—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤.
   - –•—Ä–∞–Ω–µ–Ω–∏–µ –∏ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –æ–±—â–µ–Ω–∏—è –¥–ª—è –≥–µ–Ω–µ—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–µ–∫—Å—Ç–Ω—ã—Ö –æ—Ç–≤–µ—Ç–æ–≤ —Å –ø–æ–º–æ—â—å—é —è–∑—ã–∫–æ–≤–æ–π –º–æ–¥–µ–ª–∏ GPT.

---

## ‚úÖ **Project Implementation**

This project follows a **modular architecture** with three independent services communicating via **REST API**.

### **Technologies Used**

- **Python 3.8+** (Main Language)
- **Aiogram 3** (Telegram Bot Framework)
- **FastAPI** (Backend API Service)
- **OpenAI GPT-3.5** (Natural Language Processing)
- **SQLite** (Database for user management & chat history)
- **Docker (Optional)** (For easy deployment)
- **Async Programming** (Using `aiohttp` for fast performance)

---

## üöÄ **How to Run the Project**

### **1Ô∏è‚É£ Install Dependencies**

First, install **Python 3.8+** and required dependencies:


### **2Ô∏è‚É£ Set Up Environment Variables**

Create a `.env` file in each service (`bot_service`, `api_service`, `nlp_service`):

**Example `.env` file:**

```
TELEGRAM_BOT_TOKEN=your-telegram-bot-token
OPENAI_API_KEY=your-openai-api-key
DATABASE_URL=sqlite:///./users.db
```

### **3Ô∏è‚É£ Start Each Service**

Run these in separate terminals:

- **Start API Service** (User Registration & Chat History)

  ```sh
  cd api_service
  uvicorn main:app --host 0.0.0.0 --port 8000 --reload
  ```

- **Start NLP Service** (OpenAI Chat Processing)

  ```sh
  cd nlp_service
  uvicorn main:app --host 0.0.0.0 --port 8001 --reload
  ```

- **Start Bot Service** (Telegram Bot)
  ```sh
  cd bot_service
  python3 bot.py
  ```

---

## üéØ **Project Features**

### ‚úÖ **Implemented Requirements**

| **Requirement**                                        | **Status** |
| ------------------------------------------------------ | ---------- |
| **Bot Service (Aiogram 3) working**                    | ‚úÖ Done    |
| **API Service (FastAPI) handles users & chat history** | ‚úÖ Done    |
| **NLP Service (OpenAI) generates responses**           | ‚úÖ Done    |
| **All services communicate via HTTP (REST API)**       | ‚úÖ Done    |
| **Asynchronous implementation**                        | ‚úÖ Done    |
| **Messages are saved in the database**                 | ‚úÖ Done    |
| **Users can retrieve chat history**                    | ‚úÖ Done    |
| **Bot remembers conversation context**                 | ‚úÖ Done    |
| **Proper error handling**                              | ‚úÖ Done    |
| **Swagger API documentation (`/docs`)**                | ‚úÖ Done    |
| **SOLID architecture used**                            | ‚úÖ Done    |

---

## üìù **How It Works**

1. **User sends a message** in Telegram.
2. **Bot registers user** in `api_service` if they are new.
3. **Message is saved** in `api_service` for future reference.
4. **Bot forwards message** to `nlp_service`, fetching **past chat history**.
5. **OpenAI processes the message** with full conversation context.
6. **Bot sends the AI-generated reply** back to the user.

---

## üî• **Additional Features**

- **Database-backed chat history** (Bot remembers context!)
- **Auto-reconnect & error handling** for stability.
- **REST API endpoints** for user data & chat monitoring.
- **Fast execution** using async programming.

